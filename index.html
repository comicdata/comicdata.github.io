<html>
  <head>
    <meta charset="utf-8">
    <meta name="referrer" content="never">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>comic</title>
    <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.0.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.6.1/css/bulma.min.css">
  </head>
  <body>
    <section class="section">
      <h1 id="info" class="title"></h1>
      <div id="comic"></div>
      <div class="columns">
        <div class="column">
          <p class="bd-notification is-info" onclick="window.location.href=window.location.href.match(/.*\?/)[0] + 'mid=' + mid + '&cid=' + (parseInt(cid) - 1)">Cid - 1</p>
        </div>
        <div class="column">
          <p class="bd-notification is-success" onclick="window.location.href=window.location.href.match(/.*\?/)[0] + 'mid=' + mid + '&cid=' + (parseInt(cid) + 1)">Cid + 1</p>
        </div>
      </div>
      <script>
        //config
        var gitrepo = 'https://raw.githubusercontent.com/ComicDatabase/ComicDatabase/master/';

        //get url parma
        (function ($) {
            $.getUrlParam = function (name) {
                var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
                var r = window.location.search.substr(1).match(reg);
                if (r != null) return unescape(r[2]); return null;
            }
        })(jQuery);

        //globle value
        var ele;
        var txjson;

        //set pics
        function fixPicUrl(u)
        {
          return u;
        }

        //gen element html
        function ShowPics(url) {
          if(url != ''){
            ele += '<div>';
            ele += '<img src="' + fixPicUrl(url) + '" width="100%"/>';
            ele += '</div>';
          }
        }

        function getpics(e){
          txjson = e;

          ele = '<div>';
          e.picture.forEach(function(v,i){
            console.log(v.url);
            ShowPics(v.url);
          });
          ele += '</div>';
          $("#comic")[0].innerHTML = ele;
        }

        //main
        //get info
        var mid = $.getUrlParam('mid');
        var cid = $.getUrlParam('cid');
        if(cid == null || mid == null){
          $("#info")[0].innerHTML = 'welcome!';
        }
        else {
          $("#info")[0].innerHTML = mid + '-' + cid;
          $.get('databases/' + mid + '/' + cid + '.json',getpics);
        }


      </script>
    </section>
  </body>
</html>
